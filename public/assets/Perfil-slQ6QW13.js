import{_ as E,a as N,y as B,r,z as D,A as b,b as l,w as t,B as o,D as P,E as q,F as z,d as c,G as $,H as d,I as j,i as A,J as I,K as M,L as F,M as L,N as G,O as J,P as O,v as h,x as g,C as k}from"./index-DVpeUCJe.js";const H={class:"row justify-center"},K={class:"col-12 col-md-8 col-lg-6"},R={class:"row justify-center q-mb-lg"},T={class:"column items-center"},W=["src"],X=["src"],Y={class:"q-mt-md"},Z={class:"row justify-end q-mt-md"},ee={class:"row q-col-gutter-md justify-center"},ae=["src","alt"],le={class:"text-caption q-mt-xs"},oe={__name:"Perfil",setup(te){const y=h(),V=N(),n=B(()=>V.usuario),m=r(""),v=r(""),p=r(""),_=r(""),i=r(""),C=r(""),w=r(!1),f=r(!1),u=r(""),Q=[{id:"avatar1",nombre:"Casual"},{id:"avatar2",nombre:"Profesional"},{id:"avatar3",nombre:"Deportivo"},{id:"avatar4",nombre:"Elegante"},{id:"avatar5",nombre:"Creativo"}];D(()=>{n.value&&(m.value=n.value.nombre||"",v.value=n.value.email||"",p.value=n.value.telefono||"")});const x=s=>`/avatars/${s}.svg`,S=()=>{if(u.value){const s={...n.value,avatarPredeterminado:u.value};V.updateUser(s),f.value=!1,u.value="",y.notify({color:"positive",message:"Avatar actualizado correctamente",icon:"check"})}},U=async()=>{try{w.value=!0;const s={...n.value,nombre:m.value,email:v.value,telefono:p.value};V.setUser(s),localStorage.setItem("usuario",JSON.stringify(s)),y.notify({message:"Perfil actualizado correctamente",color:"positive",icon:"check_circle"}),_.value="",i.value="",C.value=""}catch(s){console.error("Error al actualizar perfil:",s),y.notify({message:"Error al actualizar el perfil",color:"negative",icon:"error"})}finally{w.value=!1}};return(s,a)=>(g(),b("div",null,[l(j,{padding:""},{default:t(()=>[o("div",H,[o("div",K,[l(P,{class:"q-pa-lg"},{default:t(()=>[l(q,null,{default:t(()=>[a[9]||(a[9]=o("div",{class:"text-h5 q-mb-md"},"Mi Perfil",-1)),o("div",R,[o("div",T,[l(z,{size:"150px",class:"q-mb-sm bg-grey-3"},{default:t(()=>{var e;return[(e=n.value)!=null&&e.avatarPredeterminado?(g(),b("img",{key:0,src:x(n.value.avatarPredeterminado)},null,8,W)):(g(),b("img",{key:1,src:x("avatar1")},null,8,X))]}),_:1}),o("div",Y,[l(c,{color:"primary",label:"Cambiar Avatar",size:"md",onClick:a[0]||(a[0]=e=>f.value=!0),icon:"face"})])])]),l($,{onSubmit:U,class:"q-gutter-md"},{default:t(()=>[l(d,{modelValue:m.value,"onUpdate:modelValue":a[1]||(a[1]=e=>m.value=e),label:"Nombre completo",outlined:"",rules:[e=>!!e||"El nombre es obligatorio"]},null,8,["modelValue","rules"]),l(d,{modelValue:v.value,"onUpdate:modelValue":a[2]||(a[2]=e=>v.value=e),label:"Correo electrónico",outlined:"",type:"email",rules:[e=>!!e||"El correo es obligatorio",e=>/^\w+([.-]?\w+)*@\w+([.-]?\w+)*(\.\w{2,3})+$/.test(e)||"Correo inválido"]},null,8,["modelValue","rules"]),l(d,{modelValue:p.value,"onUpdate:modelValue":a[3]||(a[3]=e=>p.value=e),label:"Teléfono",outlined:"",type:"tel"},null,8,["modelValue"]),a[8]||(a[8]=o("div",{class:"text-subtitle1 q-mt-lg"},"Cambiar contraseña",-1)),l(d,{modelValue:_.value,"onUpdate:modelValue":a[4]||(a[4]=e=>_.value=e),label:"Contraseña actual",outlined:"",type:"password",rules:[e=>!e||i.value.length>0&&!!e||"Requerida para cambiar contraseña"]},null,8,["modelValue","rules"]),l(d,{modelValue:i.value,"onUpdate:modelValue":a[5]||(a[5]=e=>i.value=e),label:"Nueva contraseña",outlined:"",type:"password",rules:[e=>!e||e.length>=6||"Mínimo 6 caracteres"]},null,8,["modelValue","rules"]),l(d,{modelValue:C.value,"onUpdate:modelValue":a[6]||(a[6]=e=>C.value=e),label:"Confirmar contraseña",outlined:"",type:"password",rules:[e=>!i.value.length||e===i.value||"Las contraseñas no coinciden"]},null,8,["modelValue","rules"]),o("div",Z,[l(c,{type:"submit",color:"primary",label:"Guardar cambios",loading:w.value},null,8,["loading"])])]),_:1})]),_:1})]),_:1})])])]),_:1}),l(O,{modelValue:f.value,"onUpdate:modelValue":a[7]||(a[7]=e=>f.value=e),persistent:""},{default:t(()=>[l(P,{style:{"min-width":"400px"}},{default:t(()=>[l(q,{class:"row items-center q-pb-none"},{default:t(()=>[a[10]||(a[10]=o("div",{class:"text-h6"},"Seleccionar Avatar",-1)),l(I),A(l(c,{icon:"close",flat:"",round:"",dense:""},null,512),[[k]])]),_:1}),l(q,null,{default:t(()=>[a[11]||(a[11]=o("div",{class:"text-body2 q-mb-md text-grey-7"}," Elige uno de nuestros avatares predeterminados: ",-1)),o("div",ee,[(g(),b(M,null,F(Q,e=>o("div",{key:e.id,class:"col-4 text-center"},[l(z,{size:"80px",class:L(["cursor-pointer avatar-option",{"avatar-selected":u.value===e.id}]),onClick:se=>u.value=e.id},{default:t(()=>[o("img",{src:x(e.id),alt:e.nombre},null,8,ae)]),_:2},1032,["class","onClick"]),o("div",le,G(e.nombre),1)])),64))])]),_:1}),l(J,{align:"right"},{default:t(()=>[A(l(c,{flat:"",label:"Cancelar",color:"grey"},null,512),[[k]]),l(c,{label:"Seleccionar",color:"primary",onClick:S,disable:!u.value},null,8,["disable"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]))}},ne=E(oe,[["__scopeId","data-v-86568d31"]]);export{ne as default};

import{_ as k,a as z,y as I,r as o,z as N,c as x,w as m,A as u,b as a,B as A,D as C,E as B,F as E,o as F,G as S,d as U,H as j,I as R,J as d,K as D,L,v as $,x as b}from"./index-BzdQ1qhZ.js";const M={class:"row justify-center"},G={class:"col-12 col-md-8 col-lg-6"},J={class:"row justify-center q-mb-lg"},H={class:"column items-center"},K=["src"],O={key:0,class:"text-caption text-grey q-mt-xs"},T={class:"row justify-end q-mt-md"},W={__name:"Perfil",setup(X){const P=$(),_=z(),t=I(()=>_.usuario),c=o(""),v=o(""),p=o(""),y=o(""),n=o(""),V=o(""),s=o(null),f=o(""),w=o(!1);N(()=>{t.value&&(c.value=t.value.nombre||"",v.value=t.value.email||"",p.value=t.value.telefono||"")});const q=()=>{if(s.value){const r=new FileReader;r.onload=l=>{f.value=l.target.result},r.readAsDataURL(s.value)}else f.value=""},Q=async()=>{var r;try{w.value=!0;let l=(r=t.value)==null?void 0:r.imagenPerfil;if(s.value){const i=new FileReader;i.readAsDataURL(s.value),await new Promise(g=>{i.onload=()=>{l=i.result,g()}})}const e={...t.value,nombre:c.value,email:v.value,telefono:p.value,imagenPerfil:l};_.setUser(e),localStorage.setItem("usuario",JSON.stringify(e)),P.notify({message:"Perfil actualizado correctamente",color:"positive",icon:"check_circle"}),y.value="",n.value="",V.value=""}catch(l){console.error("Error al actualizar perfil:",l),P.notify({message:"Error al actualizar el perfil",color:"negative",icon:"error"})}finally{w.value=!1}};return(r,l)=>(b(),x(L,{padding:""},{default:m(()=>[u("div",M,[u("div",G,[a(D,{class:"q-pa-lg"},{default:m(()=>[a(A,null,{default:m(()=>[l[9]||(l[9]=u("div",{class:"text-h5 q-mb-md"},"Mi Perfil",-1)),u("div",J,[u("div",H,[a(E,{size:"150px",class:"q-mb-sm bg-grey-3"},{default:m(()=>{var e,i;return[f.value||(e=t.value)!=null&&e.imagenPerfil?(b(),C("img",{key:0,src:f.value||((i=t.value)==null?void 0:i.imagenPerfil)},null,8,K)):(b(),x(F,{key:1,name:"person",size:"100px",color:"grey-7"})),a(S,{modelValue:s.value,"onUpdate:modelValue":[l[0]||(l[0]=g=>s.value=g),q],accept:".jpg, .png, .jpeg",style:{display:"none"},ref:"fileInput"},null,8,["modelValue"]),a(U,{round:"",color:"primary",icon:"edit",size:"sm",class:"absolute-bottom-right",onClick:l[1]||(l[1]=g=>r.$refs.fileInput.pickFiles())})]}),_:1}),s.value?(b(),C("div",O,j(s.value.name),1)):B("",!0)])]),a(R,{onSubmit:Q,class:"q-gutter-md"},{default:m(()=>[a(d,{modelValue:c.value,"onUpdate:modelValue":l[2]||(l[2]=e=>c.value=e),label:"Nombre completo",outlined:"",rules:[e=>!!e||"El nombre es obligatorio"]},null,8,["modelValue","rules"]),a(d,{modelValue:v.value,"onUpdate:modelValue":l[3]||(l[3]=e=>v.value=e),label:"Correo electrónico",outlined:"",type:"email",rules:[e=>!!e||"El correo es obligatorio",e=>/^\w+([.-]?\w+)*@\w+([.-]?\w+)*(\.\w{2,3})+$/.test(e)||"Correo inválido"]},null,8,["modelValue","rules"]),a(d,{modelValue:p.value,"onUpdate:modelValue":l[4]||(l[4]=e=>p.value=e),label:"Teléfono",outlined:"",type:"tel"},null,8,["modelValue"]),l[8]||(l[8]=u("div",{class:"text-subtitle1 q-mt-lg"},"Cambiar contraseña",-1)),a(d,{modelValue:y.value,"onUpdate:modelValue":l[5]||(l[5]=e=>y.value=e),label:"Contraseña actual",outlined:"",type:"password",rules:[e=>!e||n.value.length>0&&!!e||"Requerida para cambiar contraseña"]},null,8,["modelValue","rules"]),a(d,{modelValue:n.value,"onUpdate:modelValue":l[6]||(l[6]=e=>n.value=e),label:"Nueva contraseña",outlined:"",type:"password",rules:[e=>!e||e.length>=6||"Mínimo 6 caracteres"]},null,8,["modelValue","rules"]),a(d,{modelValue:V.value,"onUpdate:modelValue":l[7]||(l[7]=e=>V.value=e),label:"Confirmar contraseña",outlined:"",type:"password",rules:[e=>!n.value.length||e===n.value||"Las contraseñas no coinciden"]},null,8,["modelValue","rules"]),u("div",T,[a(U,{type:"submit",color:"primary",label:"Guardar cambios",loading:w.value},null,8,["loading"])])]),_:1})]),_:1})]),_:1})])])]),_:1}))}},Z=k(W,[["__scopeId","data-v-e2f04286"]]);export{Z as default};

import{_ as k,y as Q,r,s as I,R as j,P as G,z as _,A as m,Y as e,B as t,$ as z,X as v,D as L,L as E,ae as R,C as b,am as $,a9 as i,a2 as F,an as f,a3 as u,Z as O,a4 as H,W as q,S as c}from"./index-BvjIyBtr.js";const J={class:"row justify-center"},Z={class:"col-12 col-md-10"},W={class:"text-h5 q-mb-md text-center"},X={key:0,class:"text-center q-pa-xl"},Y={key:1,class:"text-center q-pa-xl"},K={key:2,class:"q-gutter-md"},h={key:0},aa={class:"row justify-center q-mt-lg"},ea={key:1},la={class:"row q-col-gutter-md"},oa={class:"col-12 col-md-6"},ta={class:"col-12 col-md-6"},da={class:"row q-col-gutter-md"},sa={class:"col-12 col-md-6"},ia={class:"col-12 col-md-6"},ua={class:"row q-col-gutter-md"},na={class:"col-12 col-md-6"},ra={class:"col-12 col-md-6"},ca={class:"row q-col-gutter-md"},ma={class:"col-12 col-md-6"},va={class:"col-12 col-md-6"},ga={class:"row q-col-gutter-md"},pa={class:"col-12 col-md-6"},ba={class:"col-12 col-md-6"},fa={class:"row justify-center q-gutter-md q-mt-lg"},Ca={__name:"MisDatosMetodoPago",setup(Va){const n=j(),x=G(),C=Q(),V=r(!0),d=r(null),g=r(!1),o=r({}),y=r(!1),p=r([]),S=[{label:"Cédula de Ciudadanía",value:"CC"},{label:"Cédula de Extranjería",value:"CE"},{label:"Pasaporte",value:"PA"},{label:"NIT",value:"NIT"}],w=[{label:"PayPal",value:"paypal"},{label:"Tarjeta de Crédito",value:"tarjeta"},{label:"Efectivo",value:"efectivo"}],B=[{label:"Amazonas",value:"Amazonas"},{label:"Antioquia",value:"Antioquia"},{label:"Arauca",value:"Arauca"},{label:"Atlántico",value:"Atlántico"},{label:"Bolívar",value:"Bolívar"},{label:"Boyacá",value:"Boyacá"},{label:"Caldas",value:"Caldas"},{label:"Caquetá",value:"Caquetá"},{label:"Casanare",value:"Casanare"},{label:"Cauca",value:"Cauca"},{label:"Cesar",value:"Cesar"},{label:"Chocó",value:"Chocó"},{label:"Córdoba",value:"Córdoba"},{label:"Cundinamarca",value:"Cundinamarca"},{label:"Guainía",value:"Guainía"},{label:"Guaviare",value:"Guaviare"},{label:"Huila",value:"Huila"},{label:"La Guajira",value:"La Guajira"},{label:"Magdalena",value:"Magdalena"},{label:"Meta",value:"Meta"},{label:"Nariño",value:"Nariño"},{label:"Norte de Santander",value:"Norte de Santander"},{label:"Putumayo",value:"Putumayo"},{label:"Quindío",value:"Quindío"},{label:"Risaralda",value:"Risaralda"},{label:"San Andrés y Providencia",value:"San Andrés y Providencia"},{label:"Santander",value:"Santander"},{label:"Sucre",value:"Sucre"},{label:"Tolima",value:"Tolima"},{label:"Valle del Cauca",value:"Valle del Cauca"},{label:"Vaupés",value:"Vaupés"},{label:"Vichada",value:"Vichada"},{label:"Bogotá D.C.",value:"Bogotá D.C."}],P={Cundinamarca:["Bogotá","Soacha","Girardot","Zipaquirá","Facatativá","Chía","Mosquera","Fusagasugá"],Antioquia:["Medellín","Bello","Envigado","Itagüí","Rionegro","Sabaneta"],"Valle del Cauca":["Cali","Palmira","Buenaventura","Tuluá","Cartago"],Santander:["Bucaramanga","Floridablanca","Girón","Piedecuesta","Barrancabermeja"],Atlántico:["Barranquilla","Soledad","Malambo","Sabanalarga"],Bolívar:["Cartagena","Magangué","Turbaco"],"Bogotá D.C.":["Bogotá"]},A=async()=>{V.value=!0;try{const s=await q.get("/api/metodos-pago/mi-metodo");d.value=s.data,console.log("Datos cargados del servidor:",s.data)}catch(s){console.error("Error al cargar método de pago:",s);try{const a=localStorage.getItem("datosUsuario");if(a){const l=JSON.parse(a);d.value=l,console.log("Datos cargados desde localStorage:",l),n.notify({message:"Datos cargados desde almacenamiento local",color:"info",icon:"info"})}else d.value=null}catch(a){console.error("Error al cargar desde localStorage:",a),d.value=null,n.notify({message:"No se pudieron cargar los datos",color:"negative",icon:"error"})}}finally{V.value=!1}},M=()=>{g.value=!0,o.value={...d.value},o.value.departamento&&D(),n.notify({message:"Modo de edición activado",color:"info",icon:"edit"})},U=()=>{g.value=!1,o.value={},p.value=[],n.notify({message:"Edición cancelada",color:"warning",icon:"cancel"})},D=()=>{const s=o.value.departamento;if(s&&P[s]){p.value=P[s].map(N=>({label:N,value:N}));const a=o.value.ciudad,l=P[s];a&&!l.includes(a)&&(o.value.ciudad="")}else p.value=[],o.value.ciudad=""},T=async()=>{y.value=!0;try{const s=["tipoDocumento","numeroDocumento","nombre","apellido","email","telefono","direccion","barrio","ciudad","departamento","codigoPostal"];for(const l of s)if(!o.value[l]){n.notify({message:`El campo ${l} es obligatorio`,color:"negative",icon:"error"});return}const a=await q.post("/api/metodos-pago",o.value);d.value={...o.value},localStorage.setItem("datosUsuario",JSON.stringify(o.value)),g.value=!1,n.notify({message:"Datos actualizados correctamente",color:"positive",icon:"check_circle"})}catch(s){console.error("Error al guardar cambios:",s),n.notify({message:"Error al guardar los cambios",color:"negative",icon:"error"})}finally{y.value=!1}};return I(()=>{if(console.log("Estado de autenticación:",C.isAuthenticated),console.log("Usuario actual:",C.usuario),!C.isAuthenticated){console.log("Usuario no autenticado, redirigiendo a login"),n.notify({message:"Debes iniciar sesión para ver esta información",color:"negative",icon:"error"}),x.push("/login");return}A()}),(s,a)=>(c(),_(H,{padding:""},{default:m(()=>[e("div",J,[e("div",Z,[t(O,{class:"q-pa-md"},{default:m(()=>[t(z,null,{default:m(()=>[e("div",W,[t(E,{name:"account_circle",class:"q-mr-sm"}),a[14]||(a[14]=L(" Mis Datos de Pago "))]),V.value?(c(),v("div",X,[t(R,{color:"primary",size:"3em"}),a[15]||(a[15]=e("div",{class:"q-mt-md"},"Cargando información...",-1))])):d.value?(c(),v("div",K,[g.value?(c(),v("div",ea,[t(F,{onSubmit:T,class:"q-gutter-md"},{default:m(()=>[e("div",la,[e("div",oa,[t(f,{modelValue:o.value.tipoDocumento,"onUpdate:modelValue":a[1]||(a[1]=l=>o.value.tipoDocumento=l),options:S,label:"Tipo de Documento *",outlined:"","map-options":"","emit-value":"",rules:[l=>!!l||"El tipo de documento es obligatorio"]},null,8,["modelValue","rules"])]),e("div",ta,[t(u,{modelValue:o.value.numeroDocumento,"onUpdate:modelValue":a[2]||(a[2]=l=>o.value.numeroDocumento=l),label:"Número de Documento *",outlined:"",rules:[l=>!!l||"El número de documento es obligatorio"]},null,8,["modelValue","rules"])])]),e("div",da,[e("div",sa,[t(u,{modelValue:o.value.nombre,"onUpdate:modelValue":a[3]||(a[3]=l=>o.value.nombre=l),label:"Nombre *",outlined:"",rules:[l=>!!l||"El nombre es obligatorio"]},null,8,["modelValue","rules"])]),e("div",ia,[t(u,{modelValue:o.value.apellido,"onUpdate:modelValue":a[4]||(a[4]=l=>o.value.apellido=l),label:"Apellido *",outlined:"",rules:[l=>!!l||"El apellido es obligatorio"]},null,8,["modelValue","rules"])])]),e("div",ua,[e("div",na,[t(u,{modelValue:o.value.telefono,"onUpdate:modelValue":a[5]||(a[5]=l=>o.value.telefono=l),label:"Teléfono *",outlined:"",type:"tel",rules:[l=>!!l||"El teléfono es obligatorio"]},null,8,["modelValue","rules"])]),e("div",ra,[t(u,{modelValue:o.value.email,"onUpdate:modelValue":a[6]||(a[6]=l=>o.value.email=l),label:"Email *",outlined:"",type:"email",rules:[l=>!!l||"El email es obligatorio"]},null,8,["modelValue","rules"])])]),t(u,{modelValue:o.value.telefonoContacto,"onUpdate:modelValue":a[7]||(a[7]=l=>o.value.telefonoContacto=l),label:"Teléfono de Contacto",outlined:"",type:"tel"},null,8,["modelValue"]),t(u,{modelValue:o.value.direccion,"onUpdate:modelValue":a[8]||(a[8]=l=>o.value.direccion=l),label:"Dirección *",outlined:"",rules:[l=>!!l||"La dirección es obligatoria"]},null,8,["modelValue","rules"]),e("div",ca,[e("div",ma,[t(u,{modelValue:o.value.barrio,"onUpdate:modelValue":a[9]||(a[9]=l=>o.value.barrio=l),label:"Barrio *",outlined:"",rules:[l=>!!l||"El barrio es obligatorio"]},null,8,["modelValue","rules"])]),e("div",va,[t(u,{modelValue:o.value.codigoPostal,"onUpdate:modelValue":a[10]||(a[10]=l=>o.value.codigoPostal=l),label:"Código Postal *",outlined:"",rules:[l=>!!l||"El código postal es obligatorio"]},null,8,["modelValue","rules"])])]),e("div",ga,[e("div",pa,[t(f,{modelValue:o.value.departamento,"onUpdate:modelValue":[a[11]||(a[11]=l=>o.value.departamento=l),D],options:B,label:"Departamento *",outlined:"","map-options":"","emit-value":"",rules:[l=>!!l||"El departamento es obligatorio"]},null,8,["modelValue","rules"])]),e("div",ba,[t(f,{modelValue:o.value.ciudad,"onUpdate:modelValue":a[12]||(a[12]=l=>o.value.ciudad=l),options:p.value,label:"Ciudad *",outlined:"","map-options":"","emit-value":"",disable:!o.value.departamento,rules:[l=>!!l||"La ciudad es obligatoria"]},null,8,["modelValue","options","disable","rules"])])]),t(f,{modelValue:o.value.metodoPagoPreferido,"onUpdate:modelValue":a[13]||(a[13]=l=>o.value.metodoPagoPreferido=l),options:w,label:"Método de Pago Preferido",outlined:"","map-options":"","emit-value":""},null,8,["modelValue"]),e("div",fa,[t(b,{color:"grey",label:"Cancelar",icon:"cancel",onClick:U,flat:""}),t(b,{color:"primary",label:"Guardar Cambios",icon:"save",type:"submit",loading:y.value},null,8,["loading"])])]),_:1})])):(c(),v("div",h,[t($,null,{default:m(()=>[e("tbody",null,[e("tr",null,[a[18]||(a[18]=e("td",{class:"text-weight-bold"},"Tipo de Documento:",-1)),e("td",null,i(d.value.tipoDocumento||"No especificado"),1)]),e("tr",null,[a[19]||(a[19]=e("td",{class:"text-weight-bold"},"Número de Documento:",-1)),e("td",null,i(d.value.numeroDocumento||"No especificado"),1)]),e("tr",null,[a[20]||(a[20]=e("td",{class:"text-weight-bold"},"Nombre:",-1)),e("td",null,i(d.value.nombre||"No especificado"),1)]),e("tr",null,[a[21]||(a[21]=e("td",{class:"text-weight-bold"},"Apellido:",-1)),e("td",null,i(d.value.apellido||"No especificado"),1)]),e("tr",null,[a[22]||(a[22]=e("td",{class:"text-weight-bold"},"Email:",-1)),e("td",null,i(d.value.email||"No especificado"),1)]),e("tr",null,[a[23]||(a[23]=e("td",{class:"text-weight-bold"},"Teléfono:",-1)),e("td",null,i(d.value.telefono||"No especificado"),1)]),e("tr",null,[a[24]||(a[24]=e("td",{class:"text-weight-bold"},"Teléfono de Contacto:",-1)),e("td",null,i(d.value.telefonoContacto||"No especificado"),1)]),e("tr",null,[a[25]||(a[25]=e("td",{class:"text-weight-bold"},"Dirección:",-1)),e("td",null,i(d.value.direccion||"No especificado"),1)]),e("tr",null,[a[26]||(a[26]=e("td",{class:"text-weight-bold"},"Barrio:",-1)),e("td",null,i(d.value.barrio||"No especificado"),1)]),e("tr",null,[a[27]||(a[27]=e("td",{class:"text-weight-bold"},"Ciudad:",-1)),e("td",null,i(d.value.ciudad||"No especificado"),1)]),e("tr",null,[a[28]||(a[28]=e("td",{class:"text-weight-bold"},"Departamento:",-1)),e("td",null,i(d.value.departamento||"No especificado"),1)]),e("tr",null,[a[29]||(a[29]=e("td",{class:"text-weight-bold"},"Código Postal:",-1)),e("td",null,i(d.value.codigoPostal||"No especificado"),1)]),e("tr",null,[a[30]||(a[30]=e("td",{class:"text-weight-bold"},"Método de Pago Preferido:",-1)),e("td",null,i(d.value.metodoPagoPreferido||"No especificado"),1)])])]),_:1}),e("div",aa,[t(b,{color:"primary",label:"Editar Información",icon:"edit",onClick:M})])]))])):(c(),v("div",Y,[t(E,{name:"info",size:"4em",color:"grey-5"}),a[16]||(a[16]=e("div",{class:"text-h6 q-mt-md"},"No hay información guardada",-1)),a[17]||(a[17]=e("div",{class:"text-body2 text-grey q-mt-sm"}," Aún no has guardado tus datos de método de pago. ",-1)),t(b,{color:"primary",label:"Ir a Métodos de Pago",onClick:a[0]||(a[0]=l=>s.$router.push("/metodosdepago")),class:"q-mt-md"})]))]),_:1})]),_:1})])])]),_:1}))}},Pa=k(Ca,[["__scopeId","data-v-6986f3ea"]]);export{Pa as default};

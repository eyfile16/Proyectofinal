import{_ as E,y as N,a as h,r as i,s as B,W as g,B as e,A as r,X as t,Y as P,Z as x,$ as z,C as d,a0 as $,a1 as c,a2 as j,v as S,a3 as D,a4 as I,a5 as M,a6 as F,a7 as J,a8 as L,a9 as O,R,S as b,U as q}from"./index-BGOeEaIT.js";const G={class:"row justify-center"},W={class:"col-12 col-md-8 col-lg-6"},X={class:"row justify-center q-mb-lg"},Y={class:"column items-center"},Z=["src"],H=["src"],K={class:"q-mt-md"},T={class:"row justify-end q-mt-md"},aa={class:"row q-col-gutter-md justify-center"},ea=["src","alt"],la={class:"text-caption q-mt-xs"},oa={__name:"Perfil",setup(ta){const m=R(),y=N(),s=h(()=>y.usuario),v=i(""),p=i(""),_=i(""),u=i(""),C=i(""),V=i(!1),f=i(!1),n=i(""),A=[{id:"avatar1",nombre:"Casual"},{id:"avatar2",nombre:"Profesional"},{id:"avatar3",nombre:"Deportivo"},{id:"avatar4",nombre:"Elegante"},{id:"avatar5",nombre:"Creativo"}];B(()=>{s.value&&(v.value=s.value.nombre||"",p.value=s.value.email||"",n.value=s.value.avatarPredeterminado||"avatar1")});const w=o=>`/avatars/${o}.svg`,k=()=>{var o;n.value=((o=s.value)==null?void 0:o.avatarPredeterminado)||"avatar1",f.value=!0},Q=async()=>{if(n.value)try{const o={...s.value,avatarPredeterminado:n.value};y.setUser(o),localStorage.setItem("usuario",JSON.stringify(o)),f.value=!1,m.notify({color:"positive",message:"Avatar actualizado correctamente",icon:"check"})}catch(o){console.error("Error al actualizar avatar:",o),m.notify({color:"negative",message:"Error al actualizar el avatar",icon:"error"})}},U=async()=>{try{V.value=!0;const o={...s.value,nombre:v.value,email:p.value};y.setUser(o),localStorage.setItem("usuario",JSON.stringify(o)),m.notify({message:"Perfil actualizado correctamente",color:"positive",icon:"check_circle"}),_.value="",u.value="",C.value=""}catch(o){console.error("Error al actualizar perfil:",o),m.notify({message:"Error al actualizar el perfil",color:"negative",icon:"error"})}finally{V.value=!1}};return(o,l)=>(b(),g("div",null,[e(j,{padding:""},{default:r(()=>[t("div",G,[t("div",W,[e(P,{class:"q-pa-lg"},{default:r(()=>[e(x,null,{default:r(()=>[l[7]||(l[7]=t("div",{class:"text-h5 q-mb-md"},"Mi Perfil",-1)),t("div",X,[t("div",Y,[e(z,{size:"150px",class:"q-mb-sm bg-grey-3"},{default:r(()=>{var a;return[(a=s.value)!=null&&a.avatarPredeterminado?(b(),g("img",{key:0,src:w(s.value.avatarPredeterminado)},null,8,Z)):(b(),g("img",{key:1,src:w("avatar1")},null,8,H))]}),_:1}),t("div",K,[e(d,{color:"primary",label:"Cambiar Avatar",size:"md",onClick:k,icon:"face"})])])]),e($,{onSubmit:U,class:"q-gutter-md"},{default:r(()=>[e(c,{modelValue:v.value,"onUpdate:modelValue":l[0]||(l[0]=a=>v.value=a),label:"Nombre completo",outlined:"",rules:[a=>!!a||"El nombre es obligatorio"]},null,8,["modelValue","rules"]),e(c,{modelValue:p.value,"onUpdate:modelValue":l[1]||(l[1]=a=>p.value=a),label:"Correo electrónico",outlined:"",type:"email",rules:[a=>!!a||"El correo es obligatorio",a=>/^\w+([.-]?\w+)*@\w+([.-]?\w+)*(\.\w{2,3})+$/.test(a)||"Correo inválido"]},null,8,["modelValue","rules"]),l[6]||(l[6]=t("div",{class:"text-subtitle1 q-mt-lg"},"Cambiar contraseña",-1)),e(c,{modelValue:_.value,"onUpdate:modelValue":l[2]||(l[2]=a=>_.value=a),label:"Contraseña actual",outlined:"",type:"password",rules:[a=>!a||u.value.length>0&&!!a||"Requerida para cambiar contraseña"]},null,8,["modelValue","rules"]),e(c,{modelValue:u.value,"onUpdate:modelValue":l[3]||(l[3]=a=>u.value=a),label:"Nueva contraseña",outlined:"",type:"password",rules:[a=>!a||a.length>=6||"Mínimo 6 caracteres"]},null,8,["modelValue","rules"]),e(c,{modelValue:C.value,"onUpdate:modelValue":l[4]||(l[4]=a=>C.value=a),label:"Confirmar contraseña",outlined:"",type:"password",rules:[a=>!u.value.length||a===u.value||"Las contraseñas no coinciden"]},null,8,["modelValue","rules"]),t("div",T,[e(d,{type:"submit",color:"primary",label:"Guardar cambios",loading:V.value},null,8,["loading"])])]),_:1})]),_:1})]),_:1})])])]),_:1}),e(O,{modelValue:f.value,"onUpdate:modelValue":l[5]||(l[5]=a=>f.value=a),persistent:""},{default:r(()=>[e(P,{style:{"min-width":"400px"}},{default:r(()=>[e(x,{class:"row items-center q-pb-none"},{default:r(()=>[l[8]||(l[8]=t("div",{class:"text-h6"},"Seleccionar Avatar",-1)),e(D),S(e(d,{icon:"close",flat:"",round:"",dense:""},null,512),[[q]])]),_:1}),e(x,null,{default:r(()=>[l[9]||(l[9]=t("div",{class:"text-body2 q-mb-md text-grey-7"}," Elige uno de nuestros avatares predeterminados: ",-1)),t("div",aa,[(b(),g(I,null,M(A,a=>t("div",{key:a.id,class:"col-4 text-center"},[e(z,{size:"80px",class:F(["cursor-pointer avatar-option",{"avatar-selected":n.value===a.id}]),onClick:ra=>n.value=a.id},{default:r(()=>[t("img",{src:w(a.id),alt:a.nombre},null,8,ea)]),_:2},1032,["class","onClick"]),t("div",la,J(a.nombre),1)])),64))])]),_:1}),e(L,{align:"right"},{default:r(()=>[S(e(d,{flat:"",label:"Cancelar",color:"grey"},null,512),[[q]]),S(e(d,{label:"Seleccionar",color:"primary",onClick:Q,disable:!n.value},null,8,["disable"]),[[q]])]),_:1})]),_:1})]),_:1},8,["modelValue"])]))}},ia=E(oa,[["__scopeId","data-v-6ce589eb"]]);export{ia as default};
